From de6ce6e2bffdd24772903f13161f1784fd739f09 Mon Sep 17 00:00:00 2001
From: "howard.hsu" <howard-yh.hsu@mediatek.com>
Date: Fri, 4 Mar 2022 18:02:33 +0800
Subject: [PATCH 06/18] [patch] HAL: implement wifi_getApSecurityMFPConfig()

Change-Id: I778dfabf00408f75109e122742894acf82fff799
---
 source/wifi/wifi_hal.c | 23 +++++++++++++++++++++++
 1 file changed, 23 insertions(+)

diff --git a/source/wifi/wifi_hal.c b/source/wifi/wifi_hal.c
index 187de56c..090db60f 100644
--- a/source/wifi/wifi_hal.c
+++ b/source/wifi/wifi_hal.c
@@ -6187,6 +6187,29 @@ INT wifi_getApSecurityWpaRekeyInterval(INT apIndex, INT *output_int)
 //To-do
 INT wifi_getApSecurityMFPConfig(INT apIndex, CHAR *output_string)
 {
+    char output[16]={'\0'};
+    char config_file[MAX_BUF_SIZE] = {0};
+
+    if (!output_string)
+        return RETURN_ERR;
+
+    sprintf(config_file, "%s%d.conf", CONFIG_PREFIX, apIndex);
+    wifi_hostapdRead(config_file, "ieee80211w", output, sizeof(output));
+
+    if (strlen(output) == 0)
+        snprintf(output_string, 64, "Disabled");
+    else if (strncmp(output, "0", 1) == 0)
+        snprintf(output_string, 64, "Disabled");
+    else if (strncmp(output, "1", 1) == 0)
+        snprintf(output_string, 64, "Optional");
+    else if (strncmp(output, "2", 1) == 0)
+        snprintf(output_string, 64, "Required");
+    else {
+        wifi_dbg_printf("\n[%s]: Unexpected ieee80211w=%s", __func__, output);
+        return RETURN_ERR;
+    }
+
+    wifi_dbg_printf("\n[%s]: ieee80211w is : %s", __func__, output);
     return RETURN_OK;
 }
 INT wifi_setApSecurityMFPConfig(INT apIndex, CHAR *MfpConfig)
-- 
2.29.2

